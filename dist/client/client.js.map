{"version":3,"file":"client.js","sources":["../../src/client/blendIn.ts","../../src/client/input.ts","../../src/client/client.ts"],"sourcesContent":["import * as KeyCodes from \"keycode-js\";\r\nimport { Mesh, Scene, Vector2 } from \"three\";\r\nimport * as THREE from \"three\";\r\nimport { Input } from \"./input\";\r\n\r\nexport class BlendIn {\r\n  private dude: Mesh;\r\n  private dir: Vector2;\r\n  private speed: number;\r\n\r\n  constructor(private scene: Scene, private input: Input) {\r\n    const geo = new THREE.PlaneGeometry(1, 1, 1, 1);\r\n    const mat = new THREE.MeshBasicMaterial({ color: 0xffff00, side: THREE.DoubleSide });\r\n    this.dude = new THREE.Mesh(geo, mat);\r\n    this.dir = new THREE.Vector2(0, 0);\r\n    this.speed = 0.5;\r\n    scene.add(this.dude);\r\n\r\n  }\r\n\r\n  public handleInput() {\r\n    this.dir.set(0, 0);\r\n    if (this.input.pressed[KeyCodes.KEY_W]) {\r\n      this.dir.y = 1;\r\n    }\r\n    if (this.input.pressed[KeyCodes.KEY_S]) {\r\n      this.dir.y = -1;\r\n    }\r\n    if (this.input.pressed[KeyCodes.KEY_A]) {\r\n      this.dir.x = -1;\r\n    }\r\n    if (this.input.pressed[KeyCodes.KEY_D]) {\r\n      this.dir.x = 1;\r\n    }\r\n\r\n    if (this.dir.x !== 0 || this.dir.y !== 0) {\r\n      this.dir.normalize();\r\n    }\r\n  }\r\n\r\n  public update(time: number) {\r\n    this.handleInput();\r\n    this.dude.position.x += this.dir.x * this.speed;\r\n    this.dude.position.y += this.dir.y * this.speed;\r\n    //\r\n  }\r\n}\r\n","export class Input {\r\n    public pressed: { [code: number]: boolean | undefined } = {};\r\n\r\n    constructor() {\r\n        this.onKeyDown = (e: KeyboardEvent) => {\r\n            if (!this.pressed[e.keyCode]) {\r\n                this.keyHandler(e.keyCode);\r\n            }\r\n            this.pressed[e.keyCode] = true;\r\n        };\r\n        this.onKeyUp = (e: KeyboardEvent) => {\r\n            this.pressed[e.keyCode] = false;\r\n        };\r\n        this.contextMenu = (e: PointerEvent) => {\r\n            e.preventDefault();\r\n        };\r\n        this.dispose = () => {\r\n            document.removeEventListener(\"contextmenu\", this.contextMenu);\r\n            window.removeEventListener(\"keydown\", this.onKeyDown);\r\n            window.removeEventListener(\"keyup\", this.onKeyUp);\r\n        };\r\n\r\n        document.addEventListener(\"contextmenu\", this.contextMenu, false);\r\n        window.addEventListener(\"keydown\", this.onKeyDown, false);\r\n        window.addEventListener(\"keyup\", this.onKeyUp, false);\r\n    }\r\n\r\n    public dispose: () => void;\r\n\r\n    public onKeyDown(e: KeyboardEvent) {\r\n        if (!this.pressed[e.keyCode]) {\r\n            this.keyHandler(e.keyCode);\r\n        }\r\n        this.pressed[e.keyCode] = true;\r\n    }\r\n\r\n    public onKeyUp: (e: KeyboardEvent) => void;\r\n\r\n    public contextMenu: (e: PointerEvent) => void;\r\n\r\n    public keyHandler(key: number) {\r\n        //\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\nimport { OrthographicCamera, Scene, WebGLRenderer } from \"three\";\r\nimport { BlendIn } from \"./blendIn\";\r\nimport { Input } from \"./input\";\r\n\r\nwindow.onload = function () {\r\n  let container: HTMLElement | null;\r\n  let camera: OrthographicCamera;\r\n  let scene: Scene;\r\n  let renderer: WebGLRenderer;\r\n  let input: Input;\r\n\r\n  let game: BlendIn;\r\n\r\n  const frustumSize = 15;\r\n  const SCREEN_WIDTH = window.innerWidth;\r\n  const SCREEN_HEIGHT = window.innerHeight;\r\n\r\n  init();\r\n  animate();\r\n\r\n  function init() {\r\n    container = document.getElementById(\"container\");\r\n    if (container === null) {\r\n      throw new Error(\"Failed to find container\");\r\n    }\r\n\r\n    const aspect = window.innerWidth / window.innerHeight;\r\n    camera = new THREE.OrthographicCamera(\r\n      frustumSize * aspect / - 2, frustumSize * aspect / 2, frustumSize / 2, frustumSize / - 2, 1, 2000);\r\n    camera.position.set(3, 2.5, 15);\r\n\r\n    scene = new THREE.Scene();\r\n    scene.background = new THREE.Color(0, 0, 0);\r\n\r\n    renderer = new THREE.WebGLRenderer();\r\n    renderer.setPixelRatio(window.devicePixelRatio);\r\n\r\n    container.appendChild(renderer.domElement);\r\n\r\n    input = new Input();\r\n\r\n    onWindowResize();\r\n    window.addEventListener(\"resize\", onWindowResize, false);\r\n\r\n    game = new BlendIn(scene, input);\r\n\r\n  }\r\n\r\n  function onWindowResize() {\r\n    const aspect = window.innerWidth / window.innerHeight;\r\n\r\n    camera.left = - frustumSize * aspect / 2;\r\n    camera.right = frustumSize * aspect / 2;\r\n    camera.top = frustumSize / 2;\r\n    camera.bottom = - frustumSize / 2;\r\n    camera.updateProjectionMatrix();\r\n\r\n    renderer.setSize(window.innerWidth, window.innerHeight);\r\n  }\r\n\r\n  function animate(timestamp?: number) {\r\n    requestAnimationFrame(animate);\r\n    if (timestamp && !isNaN(timestamp)) {\r\n      game.update(timestamp);\r\n    }\r\n    renderer.render(scene, camera);\r\n  }\r\n\r\n};\r\n"],"names":["THREE.PlaneGeometry","THREE.MeshBasicMaterial","THREE.DoubleSide","THREE.Mesh","THREE.Vector2","KeyCodes.KEY_W","KeyCodes.KEY_S","KeyCodes.KEY_A","KeyCodes.KEY_D","THREE.OrthographicCamera","THREE.Scene","THREE.Color","THREE.WebGLRenderer"],"mappings":"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"}